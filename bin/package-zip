#!/bin/bash
#
# Packages mythbox for distribution as a tarball.
#
find . -name "*.pyc" | xargs rm -fv
find . -name "*.pyo" | xargs rm -fv

export rev='1.0RC2'
echo Packaging $rev 

rm -rfv target
mkdir -p target/script.mythbox
cp -r * target/script.mythbox/
cd target
zip -r script.mythbox.$rev.zip script.mythbox
exit
 
tar czf mythbox_stage.tar.gz \
    --exclude=*.log \
    --exclude=*.gz \
    --exclude=*.*~ \
    --exclude=".hg" \
    --exclude=".project" \
    --exclude=".hgignore" \
    --exclude=".pydevproject" \
    --exclude=".settings" \
    --exclude=ondemandconfig.ini \
    --exclude=doc \
    --exclude="trac" \
    --exclude="addon" \
    --exclude="mythbox_report.html" \
    --exclude="./bin" \
    --exclude="./resources/test" \
    --exclude="./resources/itest" \
    --transform s/^./MythBox/g .

mkdir -p target
cd target
tar xf ../mythbox_stage.tar.gz
rm ../mythbox_stage.tar.gz
find . -print0 | xargs -r0 touch
#sed --in-place "s/^__svn_revision__.*/__svn_revision__ = ${rev}/g" MythBox/default.py

tar czf ../mythbox-${rev}.tar.gz *
cd ..
rm -rf target

